function xyY=LMSToxyY(lms)% convert between cone lms  and cie x, y, Y values% USAGE: xyY=LMSToxyY(lms) in which lms is a list of cones triplets% % comments to Frans W. Cornelissen, email: f.w.cornelissen@med.rug.nl% History% 01-02-04  jve first version% 05-02-04  fwc edited, tidied up code% 09-02-04  FWC replaced cieToXYZ by xyYToXYZ%	22-09-04 fwc	changed to accept matrices (images)inv_Vos_walraven=[5.874506058463 -3.50012889920083 0.642539317019702;			      1.99485327854136        1        0.0221183955165016;				        0                 0        3.01751644154184];if size(lms,2)~=3	fprintf('LMSToxyY2: second dim should be 3 (=%d)\n', size(lms,2));end												XYZa=inv_Vos_walraven*lms';% XYZa;% size(XYZa);xyYa=XYZToxyY2(XYZa');% xyYa;% size(xyYa)xyY=zeros(size(xyYa));% size(xyY)xyY(:,1)=((1.00709*xyYa(:,1))+(0.00008*xyYa(:,2))+0.00009)./((-0.03867*xyYa(:,1))-(0.01537*xyYa(:,2))+1.03450);xyY(:,2)=((-0.00347*xyYa(:,1))+(1.02710*xyYa(:,2))-0.00785)./((-0.03867*xyYa(:,1))-(0.01537*xyYa(:,2))+1.03450);xyY(:,3)=xyYa(:,3);