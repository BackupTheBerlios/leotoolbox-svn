function xyY=dacToxyY(dac, M, lut, dark)% function xyY=dacToxyY(dac,M, lut, dark)% for a DAC input [R G B], returns the CIE coordinates [x y Y] (xyY)% M is matrix with conversion data for current display% lut refers to a lookup-table% dark is dark current xyY values%   01-02-04 jve    first version%   05-02-04 fwc    changed to use newDacToLum rather then find functions.%   09-02-04 fwc    changed name to dacToxyY, replaced XYZToCie by XYZToxyY% default dark values are 0if ~exist('dark', 'var') | isempty(dark)    dark=[0 0 0];endfor i=1:3    lum(i)=newDacToLum(dac(i), lut, i);end%lum=lum+dark;XYZa=M*lum';XYZd=xyYToXYZ(dark);% size(XYZa)% size(XYZd)XYZ=XYZa+XYZd';xyY=XYZToxyY(XYZ);