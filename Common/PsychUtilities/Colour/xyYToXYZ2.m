function [XYZ, z]=xyYToXYZ(xyY)% convert between xyY and tristimulus values% format: xyY=[x y Y] and XYZ=[X Y Z];% as a bonus you get small z%	22-09-04 fwc	changed to accept matrices (images)if size(xyY,2)~=3	fprintf('xyYToXYZ2: second dim of xyY should be 3 (=%d)\n', size(xyY,2));end						% size(xyY)XYZ=zeros(size(xyY));% z=zeros(size(xyY,1));z=zeros(size(xyY));% if xyY(2)==0%     XYZ=[0 0 0];%     z=0;%     return;% endq=find(xyY(:,2)~=0);XYZ(q,1)=(xyY(q,1)./xyY(q,2)).*xyY(q,3);XYZ(q,2)=xyY(q,3);XYZ(q,3)=((1-xyY(q,1)-xyY(q,2))./xyY(q,2)).*xyY(q,3);s=sum(XYZ,2);q=find(s~=0);z=XYZ(q,1)./s(q);