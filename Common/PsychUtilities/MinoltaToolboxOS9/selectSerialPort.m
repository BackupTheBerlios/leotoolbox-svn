function [port]=selectSerialPort% Pick a serial port% Part of Minolta toolbox% Send comments and bug reports to: f.w.cornelissen@med.rug.nl% history% fwc created first version in 1999% 20-01-2002	fwc	simplified code a bit, better checking of reply% 21-01-2002	fwc	added simulation mode as an optionport=-1;reply=0;p=SERIAL('Ports');[n,m]=size(p);fprintf('The following serial ports are available:\n')fprintf('(%d.) "%s" (ports %s %s)\n',0, 'Simulation mode', '', '');for i=1:m	fprintf('(%d.) "%s" (ports %s %s)\n',i, p(i).name, p(i).inputDriverName, p(i).outputDriverName);endquery=sprintf('Use which port? (select 0 to %d, q to quit)  ', m);reply=lower(input(query,'s'));if 1==strcmp( reply(1),'q')	fprintf('\nFine with me!\nBye....\n\n');	port.name='';	return;else		reply=str2num(reply(1));	fprintf('\n');	if reply==0		port.name='Simulation mode';		port.inputDriverName='';		port.outputDriverName='';		%port=0;	elseif reply>0 | reply <=m		port = p(reply);	else		fprintf('That port (%d) is not available, please try again.\n', reply);	endend